clc
clear all
close all
fm=500;
fc=5000;
% t1=0:0.00001:0.01;
t=0.00001:0.00001:0.01;
amp=0.03;
N=1;
rng(2);

ss=square(2*pi*fm*t);
figure(1)
plot(t,ss);
temp=ss;
% for i=1:100: length(ss)
%     inp((i-1)/100+1)=ss(i);
%     x=randi([0,1],1,1);
%     sign=2*x-1;
%     for j=i:i+100  
%     if(j>length(ss)) 
%         break
%     end
%     s(j)=ss(j)*sign;
%     end
% end
c=amp*sin(2*pi*fc*t);
bpsk=(s.*c);
bpsk1=bpsk';

rx=[0.26305139	0.24328855	0.21957313	0.1958577	0.1721423	0.15237945	0.12866403	0.10494861	0.085185766	0.065422922	0.061470352	0.045660079	0.03380236	0.029849797	0.021944657	0.021944657	0.02589722	0.029849797	0.03380236	0.045660079	0.049612641	0.073328063	0.089138336	0.10099605	0.12075889	0.15633202	0.17609486	0.19981028	0.22747827	0.25119367	0.27095652	0.2867668	0.30257708	0.3104822	0.31838736	0.31838736	0.31443477	0.3104822	0.30257708	0.28281423	0.27095652	0.24328855	0.21957313	0.1958577	0.17609486	0.14842688	0.12471146	0.10890118	0.089138336	0.065422922	0.049612641	0.049612641	0.037754938	0.029849797	0.021944657	0.021944657	0.021944657	0.02589722	0.03380236	0.041707501	0.053565219	0.073328063	0.081233196	0.10099605	0.12471146	0.14842688	0.17609486	0.20376284	0.22747827	0.24724111	0.27095652	0.2867668	0.29862452	0.31443477	0.31838736	0.31443477	0.31838736	0.31443477	0.29467195	0.27886167	0.26700395	0.24724111	0.2235257	0.19981028	0.1721423	0.14842688	0.12471146	0.10494861	0.089138336	0.077280626	0.049612641	0.029849797	0.037754938	0.021944657	0.02589722	0.017992094	0.02589722	0.029849797	0.037754938	0.045660079	0.053565219	0.073328063	0.085185766	0.10494861	0.12866403	0.14842688	0.17609486	0.20376284	0.2235257	0.24328855	0.27095652	0.2867668	0.30257708	0.3104822	0.31443477	0.32233992	0.31443477	0.30652964	0.29862452	0.28281423	0.26700395	0.23933597	0.21957313	0.1958577	0.17609486	0.14842688	0.12471146	0.10890118	0.089138336	0.073328063	0.049612641	0.049612641	0.02589722	0.021944657	0.02589722	0.010086954	0.021944657	0.029849797	0.03380236	0.041707501	0.041707501	0.065422922	0.085185766	0.10494861	0.12471146	0.14842688	0.17609486	0.19981028	0.22747827	0.24724111	0.27095652	0.2867668	0.30257708	0.3104822	0.31838736	0.31838736	0.31838736	0.3104822	0.29862452	0.27886167	0.26700395	0.24328855	0.2235257	0.19981028	0.17609486	0.14842688	0.12866403	0.10494861	0.093090907	0.065422922	0.061470352	0.045660079	0.037754938	0.03380236	0.02589722	0.021944657	0.021944657	0.02589722	0.037754938	0.029849797	0.057517782	0.057517782	0.085185766	0.10099605	0.12471146	0.14842688	0.17609486	0.19981028	0.22747827	0.24724111	0.27095652	0.2867668	0.30257708	0.3104822	0.31443477	0.31838736	0.31443477	0.3104822	0.29467195	0.27886167	0.26305139	0.24328855	0.21957313	0.19981028	0.17609486	0.1444743	0.12471146	0.10099605	0.089138336	0.069375493	0.057517782	0.045660079	0.029849797	0.02589722	0.02589722	0.017992094	0.021944657	0.014039516	0.03380236	0.045660079	0.057517782	0.061470352	0.085185766	0.10494861	0.12471146	0.14842688	0.17609486	0.19981028	0.22747827	0.25119367	0.27490908	0.29071939	0.29862452	0.31443477	0.31838736	0.31838736	0.31838736	0.30652964	0.29862452	0.28281423	0.26700395	0.24328855	0.21957313	0.1958577	0.1721423	0.14842688	0.13261659	0.12866403	0.13261659	0.14842688	0.16423716	0.19190514	0.21957313	0.25119367	0.27490908	0.29467195	0.31443477	0.32233992	0.32233992	0.31443477	0.29862452	0.27886167	0.25119367	0.22747827	0.19981028	0.16423716	0.12866403	0.10890118	0.081233196	0.057517782	0.037754938	0.037754938	0.02589722	0.017992094	0.014039516	0.017992094	0.017992094	0.021944657	0.03380236	0.041707501	0.045660079	0.073328063	0.097043477	0.10890118	0.13261659	0.15633202	0.17609486	0.19981028	0.2235257	0.24724111	0.26700395	0.2867668	0.29862452	0.3104822	0.31443477	0.31838736	0.3104822	0.30652964	0.29467195	0.28281423	0.26700395	0.24724111	0.21957313	0.1958577	0.17609486	0.15237945	0.12075889	0.10494861	0.081233196	0.073328063	0.049612641	0.049612641	0.029849797	0.029849797	0.021944657	0.021944657	0.02589722	0.02589722	0.029849797	0.037754938	0.049612641	0.065422922	0.089138336	0.10494861	0.12075889	0.14842688	0.1721423	0.20376284	0.22747827	0.25119367	0.27490908	0.2867668	0.30257708	0.3104822	0.32233992	0.31838736	0.31838736	0.30652964	0.29862452	0.28281423	0.26700395	0.24328855	0.2235257	0.1958577	0.1721423	0.14842688	0.12471146	0.10494861	0.081233196	0.077280626	0.053565219	0.045660079	0.037754938	0.017992094	0.02589722	0.021944657	0.021944657	0.017992094	0.017992094	0.041707501	0.053565219	0.069375493	0.077280626	0.10099605	0.12471146	0.14842688	0.17609486	0.19981028	0.22747827	0.25514627	0.27095652	0.29071939	0.29862452	0.3104822	0.31443477	0.31838736	0.31838736	0.30652964	0.29862452	0.28281423	0.25909883	0.24328855	0.21957313	0.19981028	0.1721423	0.14842688	0.12471146	0.10494861	0.085185766	0.069375493	0.061470352	0.03380236	0.021944657	0.029849797	0.02589722	0.021944657	0.021944657	0.02589722	0.037754938	0.03380236	0.053565219	0.061470352	0.085185766	0.10890118	0.12471146	0.14842688	0.1721423	0.19981028	0.2235257	0.24724111	0.27095652	0.2867668	0.29862452	0.31443477	0.32233992	0.31838736	0.31443477	0.30652964	0.29862452	0.2867668	0.26305139	0.23933597	0.2235257	0.19981028	0.1721423	0.14842688	0.12075889	0.10494861	0.089138336	0.073328063	0.061470352	0.049612641	0.037754938	0.03380236	0.017992094	0.021944657	0.02589722	0.02589722	0.021944657	0.041707501	0.057517782	0.065422922	0.085185766	0.10494861	0.12471146	0.13656917	0.15237945	0.15633202	0.15633202	0.1444743	0.12866403	0.11680632	0.089138336	0.077280626	0.053565219	0.03380236	0.02589722	0.021944657	0.021944657	0.02589722	0.03380236	0.02589722	0.061470352	0.089138336	0.10494861	0.13656917	0.1721423	0.19190514	0.23143083	0.25514627	0.27095652	0.29862452	0.31443477	0.31838736	0.32233992	0.32629251	0.32233992	0.3104822	0.29862452	0.28281423	0.26700395	0.23933597	0.21562055	0.19981028	0.17609486	0.15237945	0.12075889	0.10890118	0.089138336	0.069375493	0.049612641	0.03380236	0.037754938	0.029849797	0.010086954	0.02589722	0.02589722	0.02589722	0.037754938	0.041707501	0.041707501	0.069375493	0.077280626	0.10494861	0.12471146	0.15237945	0.1721423	0.19981028	0.2235257	0.24724111	0.27095652	0.2867668	0.29862452	0.3104822	0.31838736	0.31838736	0.31838736	0.3104822	0.29862452	0.28281423	0.26700395	0.24328855	0.21957313	0.1958577	0.17609486	0.14842688	0.12471146	0.10494861	0.093090907	0.077280626	0.053565219	0.045660079	0.029849797	0.017992094	0.02589722	0.021944657	0.021944657	0.02589722	0.037754938	0.02589722	0.049612641	0.065422922	0.085185766	0.10099605	0.12471146	0.15237945	0.17609486	0.19981028	0.22747827	0.25119367	0.26700395	0.29071939	0.30257708	0.3104822	0.31838736	0.32233992	0.31838736	0.30652964	0.29467195	0.27886167	0.26305139	0.24724111	0.21957313	0.19981028	0.17609486	0.15237945	0.12866403	0.10890118	0.093090907	0.061470352	0.057517782	0.049612641	0.037754938	0.029849797	0.021944657	0.021944657	0.021944657	0.02589722	0.029849797	0.041707501	0.053565219	0.069375493	0.081233196	0.10890118	0.12866403	0.14842688	0.17609486	0.20376284	0.22747827	0.25119367	0.27095652	0.28281423	0.30257708	0.3104822	0.31838736	0.31838736	0.31443477	0.3104822	0.29862452	0.28281423	0.26700395	0.23933597	0.2235257	0.19981028	0.1721423	0.15237945	0.12866403	0.10494861	0.093090907	0.069375493	0.057517782	0.029849797	0.02589722	0.021944657	0.021944657	0.021944657	0.017992094	0.029849797	0.03380236	0.037754938	0.057517782	0.061470352	0.081233196	0.10099605	0.12471146	0.15633202	0.17609486	0.20376284	0.22747827	0.24724111	0.27095652	0.28281423	0.29862452	0.3104822	0.31443477	0.31838736	0.31443477	0.30652964	0.29862452	0.27886167	0.26305139	0.24724111	0.21957313	0.19981028	0.1721423	0.14842688	0.13261659	0.13261659	0.12866403	0.14052173	0.16818972	0.18795256	0.2235257	0.25119367	0.27490908	0.29862452	0.31443477	0.32233992	0.32233992	0.31443477	0.30257708	0.28281423	0.25119367	0.22747827	0.1958577	0.16423716	0.13656917	0.11285375	0.085185766	0.065422922	0.03380236	0.02589722	0.021944657	0.017992094	0.010086954	0.010086954	0.021944657	0.021944657	0.03380236	0.041707501	0.057517782	0.073328063	0.089138336	0.10890118	0.12471146	0.15237945	0.17609486	0.19981028	0.23143083	0.25119367	0.26700395	0.2867668	0.30257708	0.3104822	0.31838736	0.31443477	0.31443477	0.30652964	0.29467195	0.27886167	0.26305139	0.23933597	0.2235257	0.19981028	0.17609486	0.15237945	0.12471146	0.10494861	0.093090907	0.073328063	0.045660079	0.049612641	0.037754938	0.029849797	0.017992094	0.021944657	0.021944657	0.029849797	0.037754938	0.045660079	0.041707501	0.057517782	0.093090907	0.10099605	0.12471146	0.14842688	0.17609486	0.19981028	0.22747827	0.25514627	0.27095652	0.2867668	0.30257708	0.31443477	0.31838736	0.31838736	0.31443477	0.30652964	0.29862452	0.28281423	0.26700395	0.24328855	0.21957313	0.1958577	0.17609486	0.1444743	0.12075889	0.10494861	0.093090907	0.065422922	0.061470352	0.045660079	0.037754938	0.029849797	0.021944657	0.014039516	0.021944657	0.017992094	0.021944657	0.041707501	0.045660079	0.069375493	0.077280626	0.10099605	0.12471146	0.15237945	0.17609486	0.19981028	0.2235257	0.25119367	0.27095652	0.2867668	0.30652964	0.31443477	0.31443477	0.31838736	0.31443477	0.3104822	0.29467195	0.27886167	0.26700395	0.24328855	0.21957313	0.19981028	0.17609486	0.15633202	0.12471146	0.10494861	0.089138336	0.061470352	0.049612641	0.045660079	0.037754938	0.02589722	0.029849797	0.010086954	0.014039516	0.021944657	0.03380236	0.045660079	0.057517782	0.061470352	0.089138336	0.10890118	0.12866403	0.1444743	0.17609486	0.20376284	0.22747827	0.25119367	0.27095652	0.2867668	0.29862452	0.3104822	0.31443477	0.31838736	0.31443477	0.3104822	0.29862452	0.27886167	0.26305139	0.24328855	0.2235257	0.1958577	0.17609486	0.15237945	0.12866403	0.10890118	0.093090907	0.065422922	0.057517782	0.041707501	0.021944657	0.029849797	0.021944657	0.02589722	0.017992094	0.02589722	0.029849797	0.029849797	0.053565219	0.065422922	0.077280626	0.10494861	0.12075889	0.13656917	0.15633202	0.17609486	0.1958577	0.22747827	0.24328855	0.26305139	0.28281423	0.30257708	0.3104822	0.31838736	0.31443477	0.31443477	0.30652964	0.29071939	0.27095652	0.25514627	0.22747827	0.20376284	0.17609486	0.15633202	0.12866403	0.10890118	0.093090907	0.061470352	0.053565219	0.045660079	0.03380236	0.014039516	0.014039516	0.021944657	0.02589722	0.02589722	0.037754938	0.02589722	0.061470352	0.065422922	0.089138336	0.10494861	0.12471146	0.14842688	0.18004744	0.20376284	0.2235257	0.25119367	0.27095652	0.28281423	0.30257708	0.31443477	0.31838736	0.31838736	0.31443477	0.3104822	0.29862452	0.28281423	0.26700395	0.24724111	0.2235257	0.19981028	0.18004744	0.15237945	0.12866403	0.10890118	0.085185766	0.057517782	0.045660079	0.045660079	0.037754938	0.029849797	0.02589722	0.02589722	0.021944657	0.021944657	0.029849797	0.041707501	0.057517782	0.061470352	0.077280626	0.10494861	0.12471146	0.1444743	0.17609486	0.19981028	0.23143083	0.25119367	0.26700395	0.2867668	0.29862452	0.31838736	0.31838736	0.32233992	0.31443477	0.30652964	0.29862452	0.28281423	0.26305139	0.24724111	0.2235257	0.19981028	0.1721423	0.15237945	0.12471146	0.10494861	0.085185766	0.065422922	0.057517782	0.041707501	0.037754938	0.014039516	0.02589722	0.021944657	0.02589722	0.02589722	0.037754938	0.045660079	0.057517782	0.065422922	0.077280626	0.10494861	0.12866403	0.14842688	0.17609486	0.19981028	0.22747827	0.25119367	0.26700395	0.29071939	0.29862452	0.31443477	0.31838736	0.31838736	0.31443477	0.30652964	0.29862452	0.28281423	0.26700395	0.24724111	0.2235257	0.19981028	0.1721423	0.15237945	0.12471146	0.10890118	0.089138336	0.073328063	0.045660079	0.045660079	0.037754938	0.02589722	0.021944657	0.021944657	0.021944657	0.017992094	0.017992094	0.041707501
]
for z=1:length(rx)
    r_x(z)=rx(z)-.158;
end
rx_m= r_x.*c;
  figure(2)
  plot(t,s);
 
%  figure(2)
%  plot(t1,rx_n

for i=1:100: length(rx_m)
    sum=0;
    for j=i:i+100  
    if(j>length(s)) 
        break
    end
    sum=sum+rx_m(j);
    end
    sum=sum/100;
    out((i-1)/100+1)=sum;
    if(sum>0)
        a((i-1)/100+1)=1;
    else
        a((i-1)/100+1)=-1;
    end
end
err=0;
for i= 1:length(out)/2
    if(a(i)~=inp(i))
        err=err+1;
       
    end
end
ber=err/length(out);


